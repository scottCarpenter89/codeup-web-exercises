<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mapbox API</title>

    <link href='https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.css' rel='stylesheet'/>
<!--    <link rel="stylesheet"-->
<!--          href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.css"-->
<!--          type="text/css">-->
    <link rel="stylesheet" href="css/mapbox_maps_api.css">
</head>
<body>
<main>
    <div id='map' style='width: 1120px; height: 600px;'></div>
    <div>
        <button type="button" id="save-pin">Save Pin</button>
    </div>
</main>
<script src="/js/jquery-2.2.4.js"></script>
<script src='https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.js'></script>
<!--&lt;!&ndash;Mapbox Geocoder&ndash;&gt;-->
<!--<script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.min.js"></script>-->

<!--Mapbox Token-->
<script src="js/keys.js"></script>
<script src="js/mapbox-geocoder-utils.js"></script>
<script>
    (function () {

        const startingCoor = [-95.5192, 30.1314];

        mapboxgl.accessToken = SCOTTIE_MAPBOX_API;

        const map = new mapboxgl.Map({
            container: 'map', // container ID
            style: 'mapbox://styles/mapbox/streets-v11', // style URL
            center: startingCoor, // starting position [lng, lat]
            zoom: 12 // starting zoom
        });

        let marker;
        $(document).ready(function () {
            marker = new mapboxgl.Marker( {
                draggable: true
            })
                .setLngLat(startingCoor)
                .addTo(map)
marker.on('dragend', markerEnd)
        });

        function markerEnd () {
            const coordinates = marker.getLngLat();
            console.log(coordinates);
            coordinatePopup (coordinates);


        }

        function coordinatePopup (coordinates){
const LngLatArray = [coordinates.lng, coordinates.lat];
const popup = new mapboxgl.Popup({ closeOnClick: false })
            .setLngLat(LngLatArray)
    .setHTML('<p>' + coordinates.join(', ') + '</p>');
marker.setPopup(popup);
popup.addTo(map);

        }
        // map.addControl(
        //     new MapboxGeocoder({
        //         accessToken: SCOTTIE_MAPBOX_API,
        //         mapboxgl: mapboxgl
        //     })
        // );


        // $.ajax('data/mapbox.json').done(
        //
        // )


    })();
</script>
</body>
</html>